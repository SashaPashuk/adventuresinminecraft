import API from"./services/api.js";import{USER_EXISTS_ERROR,VALID_EMAIL_ERROR,FIELD_NOT_EMPTY_ERROR,PASSWORD_MIN_CHARACTERS_ERROR,PASSWORD_MAX_CHARACTERS_ERROR,errorsLanguageLocalizationsEnum}from"./contants/errors.js";import{getLocalizedError}from"./services/errorsLanguageLocalization.js";import{getLanguageFromURLWithoutEN}from"./utils/language.js";const signupButtonElement=document.querySelector("#signup-button"),signupFormElement=document.querySelector("#signup-form"),takeDataFromFormInputs=(signupButtonElement?.addEventListener("click",e=>{e.preventDefault(),cleanFormFromErrors(signupFormElement);e=takeDataFromFormInputs(signupFormElement);e.password!==e.samePassword?(signupFormElement?.querySelector('label[for="password"]')).innerHTML=getLocalizedError(errorsLanguageLocalizationsEnum.VALID_PASSWORDS_ERROR):API.signup({email:e.email,password:e.password}).then(e=>{var r=e?.email&&e?.email[0]||"",o=e?.password&&e?.password[0]||"";[USER_EXISTS_ERROR,VALID_EMAIL_ERROR].includes(r)&&((signupFormElement?.querySelector('label[for="email"]')).innerHTML=getLocalizedError(r===VALID_EMAIL_ERROR?errorsLanguageLocalizationsEnum.VALID_EMAIL_ERROR:errorsLanguageLocalizationsEnum.USER_EXISTS_ERROR)),[FIELD_NOT_EMPTY_ERROR,PASSWORD_MIN_CHARACTERS_ERROR,PASSWORD_MAX_CHARACTERS_ERROR].includes(o)&&((signupFormElement?.querySelector('label[for="password"]')).innerHTML=getLocalizedError(o===FIELD_NOT_EMPTY_ERROR?errorsLanguageLocalizationsEnum.FIELD_NOT_EMPTY_ERROR:o===PASSWORD_MIN_CHARACTERS_ERROR?errorsLanguageLocalizationsEnum.PASSWORD_MIN_CHARACTERS_ERROR:errorsLanguageLocalizationsEnum.PASSWORD_MAX_CHARACTERS_ERROR)),"User successfully registered!"===e&&(window.location.href=getLanguageFromURLWithoutEN()+"/pages/login",localStorage.setItem("register_success",!0))})}),e=>{e=e?.querySelectorAll("input");return Array.from(e).reduce((e,r)=>({...e,[r.getAttribute("name")]:r.value}),{})}),cleanFormFromErrors=e=>{(e?.querySelectorAll("label")).forEach(e=>e.innerHTML="")};