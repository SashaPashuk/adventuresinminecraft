import{languageLocalizations}from"../contants/languageLocalizations.js";import{LanguageEventObserever}from"../utils/observer.js";import{APP_LANGUAGES,DEFAULT_LANGUAGE}from"../contants/constants.js";const getDefaultLanguage=()=>{var a=navigator.language||navigator.userLanguage,a=APP_LANGUAGES.includes(a.split("-")[0])?a.split("-")[0]:null;return localStorage.getItem("language")||a||DEFAULT_LANGUAGE},defaultLocale=getDefaultLanguage();let locale,translations={};function bindLocaleSwitcher(a){var e=document.querySelector("[data-i18n-switcher]");e&&(e.value=a,e.onchange=a=>{setLocale(a.target.value),localStorage.setItem("language",a.target.value),LanguageEventObserever.broadcast({language:a.target.value})})}async function setLocale(a){var e;a!==locale&&(e=await fetchTranslationsFor(a),locale=a,translations=e,setTimeout(translatePage,300))}document.addEventListener("DOMContentLoaded",()=>{setLocale(defaultLocale),bindLocaleSwitcher(defaultLocale)});const fetchTranslationsFor=a=>languageLocalizations[a],translatePage=()=>document.querySelectorAll("[data-i18n-key]").forEach(translateElement);function translateElement(a){var e=a.getAttribute("data-i18n-key"),e=translations[e];"INPUT"===a.nodeName&&a.dataset.i18nKey.includes("Placeholder")&&(a.placeholder=e),a.innerText=e}