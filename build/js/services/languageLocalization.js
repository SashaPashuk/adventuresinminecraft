import{languageLocalizations}from"../contants/languageLocalizations.js";import{ContentLoadingEventObserever,LanguageEventObserever}from"../utils/observer.js";import{APP_LANGUAGES,DEFAULT_LANGUAGE}from"../contants/constants.js";const getDefaultLanguage=()=>{var e=navigator.language||navigator.userLanguage,e=APP_LANGUAGES.includes(e.split("-")[0])?e.split("-")[0]:null;return localStorage.getItem("language")||e||DEFAULT_LANGUAGE},defaultLocale=getDefaultLanguage();let locale,translations={};function bindLocaleSwitcher(e){var a=document.querySelector("[data-i18n-switcher]");a&&(a.value=e,a.onchange=e=>{setLocale(e.target.value),localStorage.setItem("language",e.target.value),LanguageEventObserever.broadcast({language:e.target.value})})}async function setLocale(e){var a;e!==locale&&(a=await fetchTranslationsFor(e),locale=e,translations=a,translatePage())}ContentLoadingEventObserever.subscribe(e=>{e&&translatePage()}),document.addEventListener("DOMContentLoaded",()=>{setLocale(defaultLocale),bindLocaleSwitcher(defaultLocale)});const fetchTranslationsFor=e=>languageLocalizations[e],translatePage=()=>document.querySelectorAll("[data-i18n-key]").forEach(translateElement);function translateElement(e){var a=e.getAttribute("data-i18n-key"),a=translations[a];"INPUT"===e.nodeName&&e.dataset.i18nKey.includes("Placeholder")&&(e.placeholder=a),e.innerText=a}