import API from"./services/api.js";import{renderShopItemInfoHTML,addToastNotification}from"./utils/helpers.js";import{DEFAULT_LANGUAGE,SHOP_ITEM_TIME_USAGE}from"./contants/constants.js";import{ITEM_ADDED_TO_CART_ERROR,ITEM_ADDED_TO_CART_SUCCESS}from"./contants/errors.js";document.addEventListener("DOMContentLoaded",async()=>{var t=localStorage.getItem("item_data"),t=await API.getOneShopItem({languageCode:DEFAULT_LANGUAGE,itemId:JSON.parse(t)?.id||""});renderShopItemInfoHTML(t),addBuyShopItemEventListener(t),addShopItemAmountEventListener()});const addBuyShopItemEventListener=n=>{var t=document.querySelector(".buy-block__buy-btn");const o=document.querySelector(".quantity-control__number-title"),a=document.querySelector(".cart-container-count");t?.addEventListener("click",async t=>{t.preventDefault();var t=await API.addShopItemToCart({amount:o.innerHTML,item_id:n.id,time_to_use:SHOP_ITEM_TIME_USAGE["30_DAYS"]}),e=t?.amount&&t?.amount[0]||"";"Authentication credentials were not provided."===t?.detail&&addToastNotification({message:"You should login first."}),Boolean(e)&&addToastNotification({message:t?.amount[0]}),t===ITEM_ADDED_TO_CART_ERROR&&addToastNotification({message:ITEM_ADDED_TO_CART_ERROR}),t===ITEM_ADDED_TO_CART_SUCCESS&&"Authentication credentials were not provided."!==t?.detail&&(addToastNotification({message:ITEM_ADDED_TO_CART_SUCCESS}),a.innerHTML=Number(a.innerHTML)+1)})},addShopItemAmountEventListener=()=>{const t=document.querySelector(".quantity-control__number-title");var e=document.querySelector(".quantity-control__number-btn-reduce"),n=document.querySelector(".quantity-control__number-btn-increase");let o=parseInt(t.textContent);function a(){t.textContent=o}e.addEventListener("click",()=>{1<o&&(o--,a(),d())}),n.addEventListener("click",()=>{o++,a(),d()});const r=document.getElementById("product_price");let i=parseFloat(r.textContent.slice(1));function d(){var t=Number(i*o).toFixed(2);r.textContent="â‚¬"+t}};