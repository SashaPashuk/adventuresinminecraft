import API from"../js/services/api.js";import{addToastNotification,renderShopItemsListHTML}from"./utils/helpers.js";import{ITEM_ADDED_TO_CART_ERROR}from"./contants/errors.js";import{ITEM_ALREADY_ADDED_TO_CART,ITEM_SUCCESSFULLY_ADDED_TO_CART}from"./contants/notifications.js";import{DEFAULT_LANGUAGE,SHOP_ITEM_TIME_USAGE,SHOP_ITEM_TYPES}from"./contants/constants.js";document.addEventListener("DOMContentLoaded",async()=>{var t=document.querySelector('input[type="radio"]'),t=(t?.setAttribute("checked","true"),t?.classList.add("checked"),await API.getShopItems(DEFAULT_LANGUAGE,{type:SHOP_ITEM_TYPES.Survival}));renderShopItemsListHTML(t),addProductCartButtonsEventListeners(),addProductCardsEventListeners(t),addShopItemsTypeSwitchEventListener()});const addProductCardsEventListeners=r=>{document.querySelectorAll(".products-card")?.forEach((t,e)=>{t.addEventListener("click",()=>{localStorage.setItem("item_data",JSON.stringify({id:r?.results[e].id,type:r?.results[e].type})),window.open("/pages/product","_self")})})},addProductCartButtonsEventListeners=()=>{var t=document.querySelectorAll(".products-card__buy");const r=document.querySelector(".cart-container-count");t?.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),t.preventDefault(),API.addShopItemToCart({amount:1,item_id:e.getAttribute("data-id"),time_to_use:SHOP_ITEM_TIME_USAGE["30_DAYS"]}).then(t=>{"Authentication credentials were not provided."===t?.detail&&addToastNotification({message:"You should login first."}),t===ITEM_ADDED_TO_CART_ERROR&&addToastNotification({message:ITEM_ALREADY_ADDED_TO_CART}),t!==ITEM_ADDED_TO_CART_ERROR&&"Authentication credentials were not provided."!==t?.detail&&(addToastNotification({message:ITEM_SUCCESSFULLY_ADDED_TO_CART}),r.innerHTML=Number(r.innerHTML)+1)})})})},addShopItemsTypeSwitchEventListener=()=>{var t=document.querySelector(".products-svitch");const r=document.querySelectorAll(".products-svitch input");t?.addEventListener("change",async t=>{const e=t.target.value;t=await API.getShopItems(DEFAULT_LANGUAGE,{type:e});r?.forEach(t=>{t.value===e?(t.setAttribute("checked","true"),t.classList.add("checked")):(t.removeAttribute("checked"),t.classList.remove("checked"))}),renderShopItemsListHTML(t),addProductCartButtonsEventListeners(),addProductCardsEventListeners(t)})};