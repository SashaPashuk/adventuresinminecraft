import API from"../js/services/api.js";import{DEFAULT_LANGUAGE,SHOP_ITEM_SORT_PRICE_TYPES,SHOP_ITEM_TYPES}from"./contants/constants.js";import{renderDonationDescriptionColumnItemsHTML,renderDonationDescriptionItemDescHTML}from"./utils/helpers.js";import{LanguageEventObserever}from"./utils/observer.js";const switchButtonDD=document.querySelectorAll(".switch__button"),donationDescriptionSection=document.querySelectorAll(".donation-description__section");let lastSwitchButtonId=null;switchButtonDD.forEach(n=>{n.addEventListener("click",async()=>{var t=n.getAttribute("data-name"),e=document.getElementById(t);e&&(donationDescriptionSection.forEach(t=>{t.classList.add("d-none")}),e.classList.remove("d-none"),switchButtonDD.forEach(t=>{t.classList.remove("switch__button--active")}),n.classList.add("switch__button--active"),n.getAttribute("data-name")===SHOP_ITEM_TYPES.Anarchy.toLowerCase()?(e=localStorage.getItem("language")||DEFAULT_LANGUAGE,e=await API.getShopItems(e,{type:SHOP_ITEM_TYPES.Anarchy,sort_price:SHOP_ITEM_SORT_PRICE_TYPES.FROM_CHEAP_TO_EXPENSIVE}),renderDonationDescriptionColumnItemsHTML(e,SHOP_ITEM_TYPES.Anarchy),renderDonationDescriptionItemDescHTML(e?.results[0],SHOP_ITEM_TYPES.Anarchy),addColumnEventListeners(e?.results||null,SHOP_ITEM_TYPES.Anarchy)):(e=localStorage.getItem("language")||DEFAULT_LANGUAGE,e=await API.getShopItems(e,{type:SHOP_ITEM_TYPES.Survival,sort_price:SHOP_ITEM_SORT_PRICE_TYPES.FROM_CHEAP_TO_EXPENSIVE}),renderDonationDescriptionColumnItemsHTML(e),renderDonationDescriptionItemDescHTML(e?.results[0]),addColumnEventListeners(e?.results||null)),lastSwitchButtonId=t)})});const donationDescriptionNavBtn=document.querySelectorAll(".donation-description__nav-btn"),donationDescriptionBlock=document.querySelectorAll(".donation-description__block"),addColumnEventListeners=(donationDescriptionNavBtn.forEach(e=>{e.addEventListener("click",()=>{var t=e.getAttribute("data-name"),t=document.getElementById(t);t&&(donationDescriptionBlock.forEach(t=>{t.classList.add("d-none")}),t.classList.remove("d-none"),donationDescriptionNavBtn.forEach(t=>{t.classList.remove("donation-description__nav-btn--active")}),e.classList.add("donation-description__nav-btn--active"),lastSwitchButtonId=null)})}),LanguageEventObserever.subscribe(async t=>{if(document.querySelector(".switch__button--active").getAttribute("data-name")===SHOP_ITEM_TYPES.Anarchy.toLowerCase()){const o=document.querySelector(".donation-description__nav-btn--active."+SHOP_ITEM_TYPES.Anarchy);var e=await API.getShopItems(t.language,{type:SHOP_ITEM_TYPES.Anarchy,sort_price:SHOP_ITEM_SORT_PRICE_TYPES.FROM_CHEAP_TO_EXPENSIVE}),n=e?.results?.find(t=>o.getAttribute("data-name")===t.type.toLowerCase()+"_"+t.market_name.toLowerCase())||e?.results[0];renderDonationDescriptionColumnItemsHTML(e,SHOP_ITEM_TYPES.Anarchy,n),renderDonationDescriptionItemDescHTML(n,SHOP_ITEM_TYPES.Anarchy),addColumnEventListeners(e?.results||null,SHOP_ITEM_TYPES.Anarchy)}else{n=await API.getShopItems(t.language,{type:SHOP_ITEM_TYPES.Survival,sort_price:SHOP_ITEM_SORT_PRICE_TYPES.FROM_CHEAP_TO_EXPENSIVE});const a=document.querySelector(".donation-description__nav-btn--active."+SHOP_ITEM_TYPES.Survival);e=n?.results?.find(t=>a.getAttribute("data-name")===t.type.toLowerCase()+"_"+t.market_name.toLowerCase())||n?.results[0];renderDonationDescriptionColumnItemsHTML(n,SHOP_ITEM_TYPES.Survival,e),renderDonationDescriptionItemDescHTML(e),addColumnEventListeners(n?.results||null)}}),window.addEventListener("DOMContentLoaded",async()=>{var t=localStorage.getItem("language")||DEFAULT_LANGUAGE,t=await API.getShopItems(t,{type:SHOP_ITEM_TYPES.Survival,sort_price:SHOP_ITEM_SORT_PRICE_TYPES.FROM_CHEAP_TO_EXPENSIVE});renderDonationDescriptionColumnItemsHTML(t),renderDonationDescriptionItemDescHTML(t?.results[0]),addColumnEventListeners(t?.results||null),lastSwitchButtonId&&(t=document.querySelector(`.switch__button[data-name="${lastSwitchButtonId}"]`))&&t.classList.add("switch__button--active")}),(a,t=SHOP_ITEM_TYPES.Survival)=>{if(a){var e=document.querySelectorAll(".donation-description__nav-btn."+SHOP_ITEM_TYPES.Anarchy),n=document.querySelectorAll(".donation-description__nav-btn."+SHOP_ITEM_TYPES.Survival);const r=t!==SHOP_ITEM_TYPES.Survival?e:n;r?.forEach((n,o)=>{n?.addEventListener("click",t=>{t.preventDefault(),r?.forEach(t=>{var e=t.getAttribute("data-name");renderDonationDescriptionItemDescHTML(a[o],a[o].type),e===n.getAttribute("data-name")?t.classList.add("donation-description__nav-btn--active"):t.classList.remove("donation-description__nav-btn--active")})})})}});