import API from"../js/services/api.js";import{FIELD_NOT_EMPTY_ERROR,INCORRECT_OLD_PASSWORDS_ERROR,PASSWORD_CHANGED_SUCCESS,errorsLanguageLocalizationsEnum}from"./contants/errors.js";import{getLocalizedError}from"./services/errorsLanguageLocalization.js";import{addToastNotification}from"./utils/helpers.js";const changePasswordButtonElement=document.querySelector("#change-password-button"),changePasswordFormButtonElement=document.querySelector("#change-password-form-button"),changePasswordFirstStepContainerElement=document.querySelector(".changePassword-container-firstStep"),changePasswordSecondStepContainerElement=document.querySelector(".changePassword-container-secondStep"),cleanFormFromErrors=(changePasswordButtonElement?.addEventListener("click",()=>{changePasswordFirstStepContainerElement.classList.add("container-hidden"),changePasswordSecondStepContainerElement.classList.remove("container-hidden")}),changePasswordFormButtonElement?.addEventListener("click",async e=>{e.preventDefault(),cleanFormFromErrors(document.querySelector("form"));var r,e=document.querySelectorAll("form input");let o="";e[1].value!==e[2].value?(document?.querySelector('label[for="repeat-password"]')).innerHTML=getLocalizedError(errorsLanguageLocalizationsEnum.PASSWORDS_NOT_MATCHED_ERROR):(o=e[2].value,r=(e=await API.changePasswordRequest({old_password:e[0].value,new_password:o})).old_password&&e?.old_password[0]||e?.error||"",[FIELD_NOT_EMPTY_ERROR,INCORRECT_OLD_PASSWORDS_ERROR].includes(r)&&((document?.querySelector('label[for="old-password"]')).innerHTML=getLocalizedError(FIELD_NOT_EMPTY_ERROR===r?errorsLanguageLocalizationsEnum.FIELD_NOT_EMPTY_ERROR:errorsLanguageLocalizationsEnum.INCORRECT_OLD_PASSWORDS_ERROR)),r=e.new_password&&e?.new_password[0]||"",[FIELD_NOT_EMPTY_ERROR].includes(r)&&((document?.querySelector('label[for="new-password"]')).innerHTML=getLocalizedError(errorsLanguageLocalizationsEnum.FIELD_NOT_EMPTY_ERROR)),e?.message===PASSWORD_CHANGED_SUCCESS&&(cleanFormFromErrors(document.querySelector("form")),addToastNotification({message:getLocalizedError(errorsLanguageLocalizationsEnum.PASSWORD_CHANGED_SUCCESS)})))}),e=>{e=e?.querySelectorAll("label");Array.from(e).forEach(e=>e.innerHTML="")});